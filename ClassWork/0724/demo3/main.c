/****************************************************************************************************************************************************************
 * @file         : /Tools/home/user/Code/ClassWork/0724/demo3/main.c
 * @brief        :
 *                 小练习：设计一个函数来初始化结构体的数据，设计一个函数来显示结构体数组的所有成员
 * @author       : a_23456@foxmail.com
 * @date         : 2024-07-24 14:05:53
 * @version      : 1.0
 * @note         :
 * @Copyright    : (c)   2024-2025   a_23456@foxmail.com   All Rights Reserved
 *****************************************************************************************************************************************************************/

#include <stdio.h>
#include <string.h> // 需要包含 <string.h> 以使用 strncpy

// 定义描述狗的结构体
struct Dog {
  char name[100];      // 狗的名字
  int age;             // 狗的年龄
  char sex;            // 狗的性别，'M' 表示雄性，'F' 表示雌性
  void (*hobby)(void); // 狗的爱好，用函数指针表示
};

/****************************************************************************************************************************************************************
 * @name: bark
 * @brief: 输出狗的叫声
 * @return: void
 * @date: 2024-07-24 14:33:21
 * @version: 1.0
 * @note: 示例的爱好函数
 *****************************************************************************************************************************************************************/
void bark() { printf("Woof! Woof!\n"); }

/****************************************************************************************************************************************************************
 * @name: init_dog
 * @brief: 初始化狗的结构体
 * @param {Dog*} dog - 指向结构体 Dog 的指针
 * @param {const char*} name - 狗的名字
 * @param {int} age - 狗的年龄
 * @param {char} sex - 狗的性别
 * @param {void (*)(void)} hobby - 狗的爱好函数指针
 * @return: void
 * @date: 2024-07-24 14:33:12
 * @version: 1.0
 * @note: 使用 strncpy 避免溢出，并确保字符串以 '\0' 结尾
 *****************************************************************************************************************************************************************/
void init_dog(struct Dog *dog, const char *name, int age, char sex,
              void (*hobby)(void)) {
  strncpy(dog->name, name,
          sizeof(dog->name) -
              1); // 使用 strncpy 避免溢出，并确保字符串以 '\0' 结尾
  dog->name[sizeof(dog->name) - 1] = '\0'; // 确保字符串以 '\0' 结尾
  dog->age = age;
  dog->sex = sex;
  dog->hobby = hobby;
}

/****************************************************************************************************************************************************************
 * @name: show_dogs
 * @brief: 显示狗的结构体数组的信息
 * @param {const Dog*} dogs - 指向结构体 Dog 数组的指针
 * @param {size_t} count - 结构体数组的数量
 * @return: void
 * @date: 2024-07-24 14:33:40
 * @version: 1.0
 * @note: 遍历数组并显示每只狗的信息
 *****************************************************************************************************************************************************************/
void show_dogs(const struct Dog *dogs, size_t count) {
  for (size_t i = 0; i < count; i++) {
    printf("狗的名字: %s\n", dogs[i].name);
    printf("狗的年龄: %d\n", dogs[i].age);
    printf("狗的性别: %c\n", dogs[i].sex);
    if (dogs[i].hobby != NULL) {
      printf("狗的爱好: ");
      dogs[i].hobby(); // 调用狗的爱好函数
    }
    printf("\n");
  }
}

int main() {
  struct Dog dogArray[50] = {0}; // 初始化结构体数组

  // 初始化第一只狗
  init_dog(&dogArray[0], "小黄", 2, 'M', bark);

  // 显示所有狗的信息
  show_dogs(dogArray, 1);

  return 0;
}
